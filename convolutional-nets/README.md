[![Open in Visual Studio Code](https://classroom.github.com/assets/open-in-vscode-c66648af7eb3fe8bc4f294546bfd86ef473780cde1dea487d3c4ff354943c9ae.svg)](https://classroom.github.com/online_ide?assignment_repo_id=7873739&assignment_repo_type=AssignmentRepo)
# Лабораторная работа по курсу "Искусственный интеллект"
# Классификация изображений.

| Студент | *ФИО* |
|------|------|
| Группа  | *№* |
| Оценка 1 (обучение "с нуля") | *X* |
| Оценка 2 (transfer learning) | *X* |
| Проверил | Сошников Д.В. |

> *Комментарии проверяющего*
### Задание

Решить задачу классификации пород кошек и собак на основе датасета [Oxford-IIIT](https://www.robots.ox.ac.uk/~vgg/data/pets/).

![Dataset we will deal with](images/data.png)

#### Задание 1: Классификация Pet Faces

Обучить свёрточную нейронную сеть для классификации пород кошек и собак на основе упрощённого датасета **Pet Faces**. Самостоятельно придумать архитектуру сети, реализовать предобработку входных данных.

Для загрузки датасета используйте следующий код:

```python
!wget https://mslearntensorflowlp.blob.core.windows.net/data/petfaces.tar.gz
!tar xfz petfaces.tar.gz
!rm petfaces.tar.gz
```

В качестве результата необходимо:

* Посчитать точность классификатора на тестовом датасете
* Посчитать точность двоичной классификации "кошки против собак" на текстовом датасете
* Построить confusion matrix
* **[На хорошую и отличную оценку]** Посчитайте top-3 accuracy
* **[На отличную оценку]** Выполнить оптимизацию гиперпараметров: архитектуры сети, learning rate, количества нейронов и размеров фильтров.

Решение оформите в файле [Faces.ipynb](Faces.ipynb).

Использовать нейросетевой фреймворк в соответствии с вариантом задания:
   * Чётные варианты - PyTorch
   * Нечётные варианты - Tensorflow/Keras
#### Задание 2: Классификация полных изображений с помощью transfer learning

Используйте оригинальный датасет **Oxford Pets** и предобученные сети VGG-16/VGG-19 и ResNet для построение классификатора пород. Для загрузки датасета используйте код:

```python
!wget https://mslearntensorflowlp.blob.core.windows.net/data/oxpets_images.tar.gz
!tar xfz oxpets_images.tar.gz
!rm oxpets_images.tar.gz
```

В качестве результата необходимо:

* Посчитать точность классификатора на тестовом датасете отдельно для VGG-16/19 и ResNet, для дальнейших действий выбрать сеть с лучшей точностью
* Посчитать точность двоичной классификации "кошки против собак" на текстовом датасете
* Построить confusion matrix
* **[На отличную оценку]** Посчитайте top-3 и top-5 accuracy

Решение оформите в файле [Pets.ipynb](Pets.ipynb).

Использовать нейросетевой фреймворк, отличный от использованного в предыдущем задании, в соответствии с вариантом задания:
   * Нечётные варианты - PyTorch
   * Чётные варианты - Tensorflow/Keras

## Codespaces

По возможности, используйте GitHub Codespaces для выполнения работы. По результатам, дайте обратную связь:
1. Что понравилось?
1. Что не понравилось?
1. Какие ошибки или существенные затруднения в работе вы встречали? (По возможности, будьте как можно более подробны, указывайте шаги для воспроизведения ошибок)

## Материалы для изучения

* [Deep Learning for Image Classification Workshop](https://github.com/microsoft/workshop-library/blob/main/full/deep-learning-computer-vision/README.md)
* [Convolutional Networks](https://github.com/microsoft/AI-For-Beginners/blob/main/4-ComputerVision/07-ConvNets/README.md)
* [Transfer Learning](https://github.com/microsoft/AI-For-Beginners/blob/main/4-ComputerVision/08-TransferLearning/README.md)

# Отчет

## Часть 1

  За основу была взята архитектура сети AlexNet. Обучение производилось в 20 эпох оптимизатором Adam, с learning rate 0.0001. Качество модели составило почти 62%, что неудивительно. Точность топ-3 составила 84%.
  ![изображение](https://user-images.githubusercontent.com/62854654/169639179-604d1acb-571c-4d67-b5c9-ec42b9a2b480.png)
  
  До этой модели были попытки придумать свою архитектуру, которые не увенчались успехом. Точность в среднем была не более 5%.
  
  Двоичная классификация оказалась значительно лучше - 94%. Также была построена матрица ошибок, на которой диагональ отчетливо просматривается.
  
  ![изображение](https://user-images.githubusercontent.com/62854654/169639309-0fcf73d8-4ea7-456d-a332-b1be76c277ac.png)

  Для оптимизации параметров был проведен сравнительный анализ точности для моделей с различными learning rate (0.001, 0.00001, 0.000001), числом нейронов (512, 2048, 4096) и размерами фильтров ([8, 4, 2], [20, 10, 5], [30, 15, 7]). Параметры менялись у изначальной модели, принятой в качестве baseline-модели. Обучение производилось в 20 эпох. По итогам обучения ни один из новых гиперпараметров не показал прироста точности.
  
## Часть 2

  Были обучены модели vgg16, vgg19, ResNet для классификации пород животных. Обучение производилось в 5 эпох с learning rate 0.0001. Лучшую точность на вариационной выборке показала модель ResNet. Ее точность составила 86% Для следующих заданий использую ее.
  
  ![изображение](https://user-images.githubusercontent.com/62854654/169639743-f69beeca-c2e8-4762-9f59-b44977418918.png)
  
  Бинарная классификация кошек и собак производится с точностью 99%. Топ-3 и топ-5 точность для бинарной классификации составила 100%.
  
  Также была построенная матрица ошибок. Диагональ прорисована отчетливо, хорошо.
  
  В ходе выполнения лабораторной работы я приобрел навыки обучения и проектирования сверточных нейросетей, а также применения transfer learnig для адаптирования готовой модели под конкретную задачу.
